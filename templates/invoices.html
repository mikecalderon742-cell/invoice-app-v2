{% extends "base.html" %}
{% block content %}

<div class="dashboard-header">
    <h1>Dashboard Overview</h1>
    <div class="quick-actions">
        <a href="/" class="btn">+ New Invoice</a>
        <a href="/invoices" class="btn btn-secondary">Refresh</a>
    </div>
</div>

{% if invoices %}

<!-- KPI STRIP -->
<div class="dashboard-cards enhanced">

    <div class="card kpi orange">
        <h2>{{ total_invoices }}</h2>
        <p>Total Invoices</p>
    </div>

    <div class="card kpi green">
        <h2>${{ "{:,.2f}".format(total_revenue) }}</h2>
        <p>Total Revenue</p>
    </div>

    <div class="card kpi blue">
        <h2>${{ "{:,.2f}".format(monthly_revenue) }}</h2>
        <p>This Month</p>
        <small>{{ growth }}% of total revenue</small>
    </div>

    <div class="card kpi purple">
        <h2>${{ "{:,.2f}".format(avg_invoice) }}</h2>
        <p>Average Invoice</p>
    </div>

    <div class="card kpi teal">
        <h2>{{ paid_count }}</h2>
        <p>Paid</p>
    </div>

    <div class="card kpi red">
        <h2>{{ overdue_count }}</h2>
        <p>Overdue</p>
    </div>

</div>

<!-- TABLE -->
<div class="table-wrapper">
<table class="modern-table">
    <thead>
        {% for invoice in invoices %}
<tr class="
    {% if invoice[4] == 'Paid' %}row-paid
    {% elif invoice[4] == 'Overdue' %}row-overdue
    {% elif invoice[4] == 'Sent' %}row-sent
    {% endif %}
">
    <td>#{{ invoice[0] }}</td>
    <td>{{ invoice[1] }}</td>
    <td>${{ "{:,.2f}".format(invoice[2]) }}</td>
    <td>{{ invoice[3].strftime('%Y-%m-%d') }}</td>
    <td>
        {% if invoice[4] == "Paid" %}
            <span class="badge paid">Paid</span>
        {% elif invoice[4] == "Overdue" %}
            <span class="badge overdue">Overdue</span>
        {% elif invoice[4] == "Sent" %}
            <span class="badge sent">Sent</span>
        {% else %}
            {{ invoice[4] }}
        {% endif %}
    </td>
    <td>
        <a class="btn btn-edit" href="/edit/{{ invoice[0] }}">Edit</a>
        <a class="btn btn-danger" href="/delete/{{ invoice[0] }}">Delete</a>
    </td>
</tr>
{% endfor %}
    </tbody>
</table>
</div>

{% else %}

<div class="empty-state">
    <h3>No invoices yet</h3>
    <p>Create your first invoice to get started.</p>
    <a class="btn" href="/">Create Invoice</a>
</div>

{% endif %}

{% endblock %}