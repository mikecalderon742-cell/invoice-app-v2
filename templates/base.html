<!DOCTYPE html>
<html>
<head>
    <title>InvoicePro</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="light fade-out">

<!-- HAMBURGER -->
<div id="hamburgerBtn" class="hamburger">
    <span></span>
    <span></span>
    <span></span>
</div>

<!-- SIDEBAR -->
<div id="sidebar" class="sidebar">
    <div class="sidebar-header">
        <h3>Navigation</h3>
    </div>

    <a href="/" class="sidebar-link">Create Invoice</a>
    <a href="/invoices" class="sidebar-link">Invoice History</a>
</div>

<!-- OVERLAY -->
<div id="overlay" class="overlay"></div>

<!-- NAVBAR -->
<nav class="navbar">
    <div class="nav-left">
        <span class="logo">InvoicePro</span>
    </div>

    <div class="nav-right">
        <a href="/">Create Invoice</a>
        <a href="/invoices">Invoice History</a>
        <button id="themeToggle" class="theme-toggle">ðŸŒ™</button>
    </div>
</nav>

<div class="container">
    {% block content %}{% endblock %}
</div>

<footer class="footer">
   Â© â€¢ InvoicePro v2.1 â€¢ Mike Calderon â€¢ 2026
</footer>

<div id="loader" class="loader"></div>

<a href="/" class="floating-btn">+</a>

<div id="welcomeModal" class="welcome-modal hidden">
    <div class="welcome-content">
        <h2>Welcome to InvoicePro ðŸš€</h2>
        <p>You're now using a modern invoicing platform.</p>
        <button id="closeWelcome" class="btn">Let's Go</button>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

    /* PAGE FADE IN */
    document.body.classList.remove("fade-out");

    /* KPI ANIMATION */
    const counters = document.querySelectorAll(".kpi-number");
    counters.forEach(counter => {
        const target = parseFloat(counter.innerText.replace(/[^0-9.-]+/g,""));
        const isMoney = counter.innerText.includes("$");
        let count = 0;
        const increment = target / 50;

        function update() {
            count += increment;
            if (count < target) {
                counter.innerText = isMoney
                    ? "$" + count.toFixed(2)
                    : Math.floor(count);
                requestAnimationFrame(update);
            } else {
                counter.innerText = isMoney
                    ? "$" + target.toFixed(2)
                    : target;
            }
        }
        update();
    });

    /* HERO PARALLAX */
    const hero = document.querySelector(".hero");
    window.addEventListener("scroll", () => {
        if (hero) {
            hero.style.backgroundPositionY = window.scrollY * 0.3 + "px";
        }
    });

    /* SCROLL REVEAL */
    const reveals = document.querySelectorAll(".reveal");
    function revealOnScroll() {
        reveals.forEach((el) => {
            const windowHeight = window.innerHeight;
            const elementTop = el.getBoundingClientRect().top;
            const revealPoint = 100;
            if (elementTop < windowHeight - revealPoint) {
                el.classList.add("active");
            }
        });
    }
    window.addEventListener("scroll", revealOnScroll);
    revealOnScroll();

    /* DARK MODE */
    const toggleBtn = document.getElementById("themeToggle");
    function setTheme(theme) {
        document.body.classList.remove("light", "dark");
        document.body.classList.add(theme);
        localStorage.setItem("theme", theme);
        if (toggleBtn) {
            toggleBtn.textContent = theme === "dark" ? "â˜€ï¸" : "ðŸŒ™";
        }
    }
    if (toggleBtn) {
        toggleBtn.addEventListener("click", function () {
            const isDark = document.body.classList.contains("dark");
            setTheme(isDark ? "light" : "dark");
        });
    }
    const savedTheme = localStorage.getItem("theme") || "light";
    setTheme(savedTheme);

    /* SIDEBAR */
    const hamburger = document.getElementById("hamburgerBtn");
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");

    function openSidebar() {
        sidebar.classList.add("active");
        overlay.classList.add("active");
        hamburger.classList.add("active");
    }

    function closeSidebar() {
        sidebar.classList.remove("active");
        overlay.classList.remove("active");
        hamburger.classList.remove("active");
    }

    if (hamburger && sidebar && overlay) {
        hamburger.addEventListener("click", openSidebar);
        overlay.addEventListener("click", closeSidebar);
    }

    /* REVENUE TICKER */
    const ticker = document.getElementById("revenueTicker");
    if (ticker) {
        let value = 12450;
        setInterval(() => {
            value += Math.floor(Math.random() * 50);
            ticker.innerText = "$" + value.toLocaleString() + ".00";
        }, 3000);
    }

    /* ONBOARDING MODAL */
    const modal = document.getElementById("welcomeModal");
    const closeBtn = document.getElementById("closeWelcome");

    if (modal && !localStorage.getItem("invoiceProWelcomeSeen")) {
        modal.classList.remove("hidden");
    }

    if (closeBtn && modal) {
        closeBtn.addEventListener("click", function () {
            modal.classList.add("hidden");
            localStorage.setItem("invoiceProWelcomeSeen", "true");
        });
    }

});
</script>

</body>
</html>
